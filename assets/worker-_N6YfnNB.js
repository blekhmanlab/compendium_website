(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C=Symbol("Comlink.proxy"),H=Symbol("Comlink.endpoint"),j=Symbol("Comlink.releaseProxy"),x=Symbol("Comlink.finalizer"),b=Symbol("Comlink.thrown"),z=e=>typeof e=="object"&&e!==null||typeof e=="function",I={canHandle:e=>z(e)&&e[C],serialize(e){const{port1:t,port2:r}=new MessageChannel;return k(e,t),[r,[r]]},deserialize(e){return e.start(),D(e)}},V={canHandle:e=>z(e)&&b in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},R=new Map([["proxy",I],["throw",V]]);function F(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function k(e,t=globalThis,r=["*"]){t.addEventListener("message",function o(n){if(!n||!n.data)return;if(!F(r,n.origin)){console.warn(`Invalid origin '${n.origin}' for comlink proxy`);return}const{id:a,type:u,path:l}=Object.assign({path:[]},n.data),f=(n.data.argumentList||[]).map(m);let s;try{const i=l.slice(0,-1).reduce((c,w)=>c[w],e),g=l.reduce((c,w)=>c[w],e);switch(u){case"GET":s=g;break;case"SET":i[l.slice(-1)[0]]=m(n.data.value),s=!0;break;case"APPLY":s=g.apply(i,f);break;case"CONSTRUCT":{const c=new g(...f);s=$(c)}break;case"ENDPOINT":{const{port1:c,port2:w}=new MessageChannel;k(e,w),s=Y(c,[c])}break;case"RELEASE":s=void 0;break;default:return}}catch(i){s={value:i,[b]:0}}Promise.resolve(s).catch(i=>({value:i,[b]:0})).then(i=>{const[g,c]=M(i);t.postMessage(Object.assign(Object.assign({},g),{id:a}),c),u==="RELEASE"&&(t.removeEventListener("message",o),T(t),x in e&&typeof e[x]=="function"&&e[x]())}).catch(i=>{const[g,c]=M({value:new TypeError("Unserializable return value"),[b]:0});t.postMessage(Object.assign(Object.assign({},g),{id:a}),c)})}),t.start&&t.start()}function W(e){return e.constructor.name==="MessagePort"}function T(e){W(e)&&e.close()}function D(e,t){const r=new Map;return e.addEventListener("message",function(n){const{data:a}=n;if(!a||!a.id)return;const u=r.get(a.id);if(u)try{u(a)}finally{r.delete(a.id)}}),A(e,r,[],t)}function E(e){if(e)throw new Error("Proxy has been released and is not useable")}function O(e){return d(e,new Map,{type:"RELEASE"}).then(()=>{T(e)})}const p=new WeakMap,S="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(p.get(e)||0)-1;p.set(e,t),t===0&&O(e)});function G(e,t){const r=(p.get(t)||0)+1;p.set(t,r),S&&S.register(e,t,e)}function U(e){S&&S.unregister(e)}function A(e,t,r=[],o=function(){}){let n=!1;const a=new Proxy(o,{get(u,l){if(E(n),l===j)return()=>{U(a),O(e),t.clear(),n=!0};if(l==="then"){if(r.length===0)return{then:()=>a};const f=d(e,t,{type:"GET",path:r.map(s=>s.toString())}).then(m);return f.then.bind(f)}return A(e,t,[...r,l])},set(u,l,f){E(n);const[s,i]=M(f);return d(e,t,{type:"SET",path:[...r,l].map(g=>g.toString()),value:s},i).then(m)},apply(u,l,f){E(n);const s=r[r.length-1];if(s===H)return d(e,t,{type:"ENDPOINT"}).then(m);if(s==="bind")return A(e,t,r.slice(0,-1));const[i,g]=L(f);return d(e,t,{type:"APPLY",path:r.map(c=>c.toString()),argumentList:i},g).then(m)},construct(u,l){E(n);const[f,s]=L(l);return d(e,t,{type:"CONSTRUCT",path:r.map(i=>i.toString()),argumentList:f},s).then(m)}});return G(a,e),a}function q(e){return Array.prototype.concat.apply([],e)}function L(e){const t=e.map(M);return[t.map(r=>r[0]),q(t.map(r=>r[1]))]}const N=new WeakMap;function Y(e,t){return N.set(e,t),e}function $(e){return Object.assign(e,{[C]:!0})}function M(e){for(const[t,r]of R)if(r.canHandle(e)){const[o,n]=r.serialize(e);return[{type:"HANDLER",name:t,value:o},n]}return[{type:"RAW",value:e},N.get(e)||[]]}function m(e){switch(e.type){case"HANDLER":return R.get(e.name).deserialize(e.value);case"RAW":return e.value}}function d(e,t,r,o){return new Promise(n=>{const a=X();t.set(a,n),e.start&&e.start(),e.postMessage(Object.assign({id:a},r),o)})}function X(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const J=()=>{y==null||y("Starting");let e=0;const t=5e8;for(let r=0;r<t;r++)r%(t/100)===0&&(y==null||y(`${100*r/t}% done`)),e+=Math.sqrt(Math.random())**2;return e},P=e=>e.replaceAll("_"," ").replaceAll(/\s/g," ").toLowerCase(),K=(e,t,r)=>e.filter(o=>{if(h)throw Error(h);return P(t.map(n=>String(o[n]??"")).join(" ").toLowerCase()).includes(P(r))}),Q=(e,t,r,o=.25)=>e.filter(n=>{if(h)throw Error(h);return Z(P(t.map(a=>String(n[a]??"")).join(" ")),P(r))>o}),_=(e,t=3)=>{const r=" ".repeat(t-1);return e=r+e+r,Array(e.length-t+1).fill("").map((o,n)=>e.slice(n,n+t))},Z=(e,t,r=3)=>{if(e===t)return 1;const o=new Set(_(e,r)),n=new Set(_(t,r)),a=o.intersection(n),u=o.union(n);return a.size/(u.size||1/0)};let y;const B=e=>y=e;let h="";k({expensiveFunction:J,exactSearch:K,fuzzySearch:Q,setProgress:B,abort:(e="aborted")=>h=e})})();
